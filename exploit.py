import subprocess

def sql_injection_test(target_url):
    """
    Perform aggressive SQL Injection testing using sqlmap.
    
    Args:
        target_url (str): The target URL to test for SQL injection.
    
    Returns:
        str: The output from the sqlmap tool if successful.
        None: If an error or timeout occurs.
    """
    try:
        print("[+] Starting SQL Injection testing on:", target_url)
        
        # Running sqlmap with custom parameters
        result = subprocess.run(
            ['sqlmap', '-u', target_url, '--batch', '--crawl=1', '--level=2', '--risk=2', '--timeout=60', '--time-sec=5'],
            stdout=subprocess.PIPE, 
            stderr=subprocess.PIPE,  # Capture both stdout and stderr
            timeout=600  # 10 minutes timeout for the test
        )

        if result.returncode == 0:
            return result.stdout.decode('utf-8')  # Return the result if the test succeeds
        else:
            print(f"Error during SQL Injection test: {result.stderr.decode('utf-8')}")
            return None

    except subprocess.TimeoutExpired:
        print("[!] SQL Injection test timed out.")
        return None
    except Exception as e:
        print(f"[!] Error during SQL Injection test: {e}")
        return None
