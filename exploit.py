import subprocess

def sql_injection_test(target_url):
    try:
        print("[+] Starting aggressive SQL Injection testing...")
        result = subprocess.run(
            ['sqlmap', '-u', target_url, '--batch', '--crawl=1', '--level=2', '--risk=2', '--timeout=60', '--time-sec=5'],
            stdout=subprocess.PIPE,
            timeout=600  # 10 minutes timeout for the entire SQL injection test
        )
        return result.stdout.decode('utf-8')
    except subprocess.TimeoutExpired:
        print("SQL Injection test timed out.")
        return None
    except Exception as e:
        print(f"Error during SQL Injection test: {e}")
        return None
